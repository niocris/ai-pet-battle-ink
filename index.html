<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Pet Arena - Ink Blockchain</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(180deg, #1a1443 0%, #2d1b69 100%);
            min-height: 100vh;
            color: white;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 20px 0;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #7c3aed 0%, #db2777 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(124, 58, 237, 0.5);
        }

        .logo-icon {
            font-size: 2em;
        }

        .title {
            font-size: 2em;
            font-weight: bold;
            color: white;
        }

        .connect-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .connect-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .connect-btn.connected {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: none;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: white;
        }

        .main-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            padding: 50px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .pet-display-area {
            margin: 30px 0;
        }

        .pet-image-container {
            width: 280px;
            height: 280px;
            margin: 0 auto 30px;
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.3) 0%, rgba(219, 39, 119, 0.3) 100%);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 40px rgba(124, 58, 237, 0.4);
        }

        .pet-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .pet-emoji {
            font-size: 8em;
        }

        .empty-pet {
            font-size: 6em;
            opacity: 0.3;
        }

        .special-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .pet-name {
            font-size: 2em;
            font-weight: bold;
            margin: 20px 0 10px;
            color: white;
        }

        .pet-badges {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            border: 2px solid;
        }

        .type-badge {
            border-color: rgba(255, 255, 255, 0.3);
        }

        .type-rock { background: rgba(184, 134, 11, 0.3); border-color: #b8860b; }
        .type-fly { background: rgba(135, 206, 235, 0.3); border-color: #87ceeb; }
        .type-electric { background: rgba(255, 215, 0, 0.3); border-color: #ffd700; color: #333; }
        .type-fire { background: rgba(255, 107, 107, 0.3); border-color: #ff6b6b; }
        .type-water { background: rgba(78, 205, 196, 0.3); border-color: #4ecdc4; }
        .type-grass { background: rgba(149, 225, 211, 0.3); border-color: #95e1d3; }

        .rarity-common { 
            background: rgba(149, 165, 166, 0.3); 
            border-color: #95a5a6;
        }
        .rarity-rare { 
            background: rgba(52, 152, 219, 0.3); 
            border-color: #3498db;
        }
        .rarity-unique { 
            background: rgba(155, 89, 182, 0.3); 
            border-color: #9b59b6;
        }
        .rarity-legendary { 
            background: linear-gradient(135deg, rgba(243, 156, 18, 0.5) 0%, rgba(230, 126, 34, 0.5) 100%);
            border-color: #f39c12;
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(243, 156, 18, 0.5); }
            50% { box-shadow: 0 0 30px rgba(243, 156, 18, 0.8); }
        }

        .pet-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            max-width: 400px;
            margin: 30px auto 0;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-item-label {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 8px;
        }

        .stat-item-value {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
        }

        .mint-text {
            font-size: 1.3em;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.8);
        }

        .mint-btn {
            background: linear-gradient(135deg, #7c3aed 0%, #db2777 100%);
            border: none;
            color: white;
            padding: 20px 50px;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.4);
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .mint-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(124, 58, 237, 0.6);
        }

        .mint-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .price-tag {
            font-size: 0.85em;
            opacity: 0.8;
        }

        .daily-quest {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2) 0%, rgba(217, 119, 6, 0.2) 100%);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(245, 158, 11, 0.5);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .quest-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .quest-title {
            font-size: 1.4em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quest-reward {
            color: #10b981;
            font-weight: bold;
            font-size: 1.1em;
        }

        .quest-desc {
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 20px;
        }

        .gm-btn {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            border: none;
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 5px 20px rgba(245, 158, 11, 0.4);
        }

        .gm-btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        .gm-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quest-timer {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px 20px;
            border-radius: 15px;
            margin-top: 15px;
            font-weight: bold;
        }

        .info-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .info-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-section p {
            color: rgba(255, 255, 255, 0.7);
            margin: 8px 0;
            line-height: 1.6;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-content {
            text-align: center;
        }

        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #7c3aed;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.2em;
            color: white;
        }

        .wallet-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
            align-items: flex-end;
        }

        .wallet-address {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.7);
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .main-card {
                padding: 30px 20px;
            }

            .pet-image-container {
                width: 220px;
                height: 220px;
            }

            .pet-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <div class="logo">
                    <span class="logo-icon">üéÆ</span>
                </div>
                <div class="title">AI Pet Arena</div>
            </div>
            <div>
                <button id="walletBtn" class="connect-btn" onclick="toggleWallet()">
                    üîå Connect Wallet
                </button>
                <div id="walletInfo" class="wallet-info" style="display: none;">
                    <span id="walletAddress" class="wallet-address"></span>
                </div>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">
                    <span>üé®</span> Pets Minted
                </div>
                <div class="stat-value" id="mintCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">
                    <span>‚òÄÔ∏è</span> GM Streaks
                </div>
                <div class="stat-value" id="gmCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">
                    <span>üí∞</span> Total Spent
                </div>
                <div class="stat-value" id="totalSpent">0.00000</div>
            </div>
        </div>

        <div class="main-card">
            <div id="emptyState">
                <div class="mint-text">Mint your first AI-generated pet!</div>
                <div class="pet-image-container">
                    <div class="empty-pet">üé≤</div>
                </div>
                <button class="mint-btn" onclick="mintPet()">
                    üé≤ Mint Pet
                    <span class="price-tag">(0.00001 ETH)</span>
                </button>
            </div>

            <div id="petDisplay" style="display: none;">
                <div class="pet-display-area">
                    <div class="pet-image-container" id="petImageContainer">
                        <div class="pet-emoji">üéÆ</div>
                    </div>
                    <div class="pet-name" id="petName">Your Pet</div>
                    <div class="pet-badges" id="petBadges">
                        <span class="badge type-badge type-rock">ROCK</span>
                        <span class="badge rarity-common">‚ö™ COMMON</span>
                    </div>
                    
                    <div class="pet-stats">
                        <div class="stat-item">
                            <div class="stat-item-label">‚ù§Ô∏è HP</div>
                            <div class="stat-item-value" id="statHP">10</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-item-label">‚öîÔ∏è ATK</div>
                            <div class="stat-item-value" id="statATK">10</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-item-label">üõ°Ô∏è DEF</div>
                            <div class="stat-item-value" id="statDEF">10</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-item-label">‚ö° Speed</div>
                            <div class="stat-item-value" id="statSpeed">10</div>
                        </div>
                    </div>
                </div>
                <button class="mint-btn" onclick="mintPet()" style="margin-top: 30px;">
                    üîÑ Mint New Pet
                    <span class="price-tag">(0.00001 ETH)</span>
                </button>
            </div>
        </div>

        <div class="daily-quest">
            <div class="quest-header">
                <div class="quest-title">
                    <span>‚òÄÔ∏è</span> Daily GM Quest
                </div>
                <div class="quest-reward">+0.000005 ETH</div>
            </div>
            <div class="quest-desc">
                Say GM to the community every day! Complete this quest to earn rewards.
            </div>
            <div style="text-align: center;">
                <button id="gmButton" class="gm-btn" onclick="doGM()">
                    ‚òÄÔ∏è GM!
                </button>
            </div>
            <div class="quest-timer">
                Next GM available in: <span id="countdown" style="color: #10b981;">00:00:00</span>
            </div>
        </div>

        <div class="info-section">
            <div class="info-title">üéÆ How It Works</div>
            <p><strong>1.</strong> Connect your Ink wallet</p>
            <p><strong>2.</strong> Mint AI-generated pets for 0.00001 ETH each</p>
            <p><strong>3.</strong> Say GM daily to earn 0.000005 ETH</p>
            <p><strong>4.</strong> Collect unique pets and build your collection!</p>
        </div>

        <div class="info-section">
            <div class="info-title">‚ú® Rarity System</div>
            <p><strong>‚ö™ Common (50%)</strong> - Stats: 1-10</p>
            <p><strong>üîµ Rare (30%)</strong> - Stats: 7-14</p>
            <p><strong>üü£ Unique (15%)</strong> - Stats: 13-18 | Special creatures like Dragons!</p>
            <p><strong>üü° Legendary (5%)</strong> - Stats: 14-20 | Ultimate power!</p>
        </div>

        <div class="info-section">
            <div class="info-title">üåê About Ink Blockchain</div>
            <p>Ink is an Ethereum Layer 2 optimized for consumer apps. Ultra-low fees make it perfect for NFT minting and daily interactions!</p>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <div class="loading-text" id="loadingText">Loading...</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <script>
        let walletConnected = false;
        let userAddress = null;
        let provider = null;
        let signer = null;
        let currentPet = null;
        
        let mintCount = 0;
        let gmCount = 0;
        let totalSpent = 0;
        let lastGMTime = 0;

        const MINT_PRICE = "0.00001";
        const GM_REWARD = "0.000005";
        const GM_COOLDOWN = 24 * 60 * 60 * 1000;
        const HF_API_KEY = "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";
        const HF_MODEL = "CompVis/stable-diffusion-v1-4";

        const INK_TESTNET = {
            chainId: '0xBAAC2',
            chainName: 'Ink Sepolia Testnet',
            nativeCurrency: { name: 'ETH', symbol: 'ETH', decimals: 18 },
            rpcUrls: ['https://rpc-gel-sepolia.inkonchain.com'],
            blockExplorerUrls: ['https://explorer-sepolia.inkonchain.com']
        };

        const petTypes = ['rock', 'fly', 'electric', 'fire', 'water', 'grass'];
        
        const rarities = {
            common: { weight: 50, color: '#95a5a6', emoji: '‚ö™', statMin: 1, statMax: 10 },
            rare: { weight: 30, color: '#3498db', emoji: 'üîµ', statMin: 7, statMax: 14 },
            unique: { weight: 15, color: '#9b59b6', emoji: 'üü£', statMin: 13, statMax: 18 },
            legendary: { weight: 5, color: '#f39c12', emoji: 'üü°', statMin: 14, statMax: 20 }
        };

        const specialCreatures = {
            dragon: {
                types: ['fire', 'electric', 'fly'],
                minRarity: 'unique',
                description: 'ancient dragon with powerful wings and scales'
            },
            phoenix: {
                types: ['fire'],
                minRarity: 'unique',
                description: 'immortal phoenix wreathed in eternal flames'
            },
            leviathan: {
                types: ['water'],
                minRarity: 'rare',
                description: 'massive sea leviathan from the deep ocean'
            },
            treant: {
                types: ['grass'],
                minRarity: 'rare',
                description: 'ancient tree spirit guardian of the forest'
            },
            golem: {
                types: ['rock'],
                minRarity: 'common',
                description: 'stone golem with massive boulder armor'
            }
        };
        
        const petEmojis = {
            rock: ['üóø', 'ü™®', '‚õ∞Ô∏è'],
            fly: ['ü¶Ö', 'ü¶ã', 'üïäÔ∏è'],
            electric: ['‚ö°', 'üîå', '‚≠ê'],
            fire: ['üî•', 'üåã', '‚òÑÔ∏è'],
            water: ['üíß', 'üåä', '‚ùÑÔ∏è'],
            grass: ['üåø', 'üå±', 'üçÉ']
        };

        const petDescriptions = {
            rock: {
                common: 'small stone creature with rough texture',
                rare: 'crystalline rock beast with sharp edges',
                unique: 'massive stone golem with ancient runes',
                legendary: 'titan made of pure diamond and obsidian'
            },
            fly: {
                common: 'tiny flying insect with fragile wings',
                rare: 'elegant bird with colorful plumage',
                unique: 'mystical griffin with golden feathers',
                legendary: 'celestial phoenix soaring through clouds'
            },
            electric: {
                common: 'small spark elemental crackling with energy',
                rare: 'lightning wolf running with electric speed',
                unique: 'thunder dragon breathing pure electricity',
                legendary: 'storm titan commanding all lightning'
            },
            fire: {
                common: 'flickering flame sprite dancing wildly',
                rare: 'blazing salamander with burning tail',
                unique: 'inferno demon wreathed in hellfire',
                legendary: 'cosmic phoenix reborn from stars'
            },
            water: {
                common: 'water droplet creature flowing gently',
                rare: 'frost serpent with icy scales',
                unique: 'kraken with massive tentacles',
                legendary: 'ocean leviathan controlling all seas'
            },
            grass: {
                common: 'vine sprite with tiny leaves',
                rare: 'flower beast blooming with power',
                unique: 'ancient treant guardian of forests',
                legendary: 'world tree spirit connecting all nature'
            }
        };

        function loadData() {
            mintCount = parseInt(localStorage.getItem('mintCount') || '0');
            gmCount = parseInt(localStorage.getItem('gmCount') || '0');
            totalSpent = parseFloat(localStorage.getItem('totalSpent') || '0');
            lastGMTime = parseInt(localStorage.getItem('lastGMTime') || '0');
            
            const savedPet = localStorage.getItem('currentPet');
            if (savedPet) {
                currentPet = JSON.parse(savedPet);
                showPet();
            }
            
            updateStats();
            updateGMButton();
        }

        function saveData() {
            localStorage.setItem('mintCount', mintCount);
            localStorage.setItem('gmCount', gmCount);
            localStorage.setItem('totalSpent', totalSpent);
            localStorage.setItem('lastGMTime', lastGMTime);
            if (currentPet) {
                localStorage.setItem('currentPet', JSON.stringify(currentPet));
            }
        }

        function updateStats() {
            document.getElementById('mintCount').textContent = mintCount;
            document.getElementById('gmCount').textContent = gmCount;
            document.getElementById('totalSpent').textContent = totalSpent.toFixed(5);
        }

        async function toggleWallet() {
            if (walletConnected) {
                disconnectWallet();
            } else {
                await connectWallet();
            }
        }

        async function connectWallet() {
            if (typeof window.ethereum === 'undefined') {
                alert('Please install MetaMask to connect your wallet!');
                return;
            }

            try {
                provider = new ethers.BrowserProvider(window.ethereum);
                const accounts = await provider.send("eth_requestAccounts", []);
                userAddress = accounts[0];

                try {
                    await window.ethereum.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: INK_TESTNET.chainId }],
                    });
                } catch (switchError) {
                    if (switchError.code === 4902) {
                        await window.ethereum.request({
                            method: 'wallet_addEthereumChain',
                            params: [INK_TESTNET],
                        });
                    }
                }

                signer = await provider.getSigner();
                walletConnected = true;

                document.getElementById('walletBtn').textContent = '‚úÖ Connected';
                document.getElementById('walletBtn').classList.add('connected');
                document.getElementById('walletAddress').textContent = 
                    `${userAddress.substring(0, 6)}...${userAddress.substring(38)}`;
                document.getElementById('walletInfo').style.display = 'flex';

            } catch (error) {
                console.error('Connection error:', error);
                alert('Failed to connect wallet: ' + error.message);
            }
        }

        function disconnectWallet() {
            walletConnected = false;
            userAddress = null;
            provider = null;
            signer = null;

            document.getElementById('walletBtn').textContent = 'üîå Connect Wallet';
            document.getElementById('walletBtn').classList.remove('connected');
            document.getElementById('walletInfo').style.display = 'none';
        }

        function getRarity() {
            const rand = Math.random() * 100;
            let cumulative = 0;
            
            for (const [rarity, data] of Object.entries(rarities)) {
                cumulative += data.weight;
                if (rand <= cumulative) {
                    return rarity;
                }
            }
            return 'common';
        }

        function generateStats(rarity) {
            const rarityData = rarities[rarity];
            return {
                hp: Math.floor(Math.random() * (rarityData.statMax - rarityData.statMin + 1)) + rarityData.statMin,
                atk: Math.floor(Math.random() * (rarityData.statMax - rarityData.statMin + 1)) + rarityData.statMin,
                def: Math.floor(Math.random() * (rarityData.statMax - rarityData.statMin +
