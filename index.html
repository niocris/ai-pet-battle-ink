<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Pet Mint - Ink Blockchain</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e1b4b 0%, #4c1d95 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo-img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .title-section h1 {
            font-size: 2em;
            background: linear-gradient(135deg, #a78bfa 0%, #ec4899 50%, #f472b6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .ink-badge {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
            display: inline-block;
        }

        .wallet-section {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .wallet-btn {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: transform 0.2s;
        }

        .wallet-btn:hover {
            transform: translateY(-2px);
        }

        .wallet-btn.connected {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .wallet-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .wallet-address {
            font-size: 0.85em;
            color: #666;
            background: #f5f7fa;
            padding: 5px 12px;
            border-radius: 15px;
        }

        .balance {
            font-size: 0.85em;
            color: #27ae60;
            background: #e8f8f5;
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: bold;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            padding: 20px 30px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            min-width: 140px;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-content {
            text-align: center;
            margin: 40px 0;
        }

        .pet-display {
            margin: 30px auto;
            max-width: 300px;
        }

        .pet-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .pet-image-container {
            width: 200px;
            height: 200px;
            margin: 0 auto 20px;
            border-radius: 15px;
            overflow: hidden;
            background: #2d1b4e;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pet-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .pet-emoji {
            font-size: 6em;
        }

        .pet-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            margin: 15px 0;
        }

        .pet-type {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin: 10px 0;
        }

        .type-rock { background: #b8860b; color: white; }
        .type-paper { background: #4a90e2; color: white; }
        .type-scissors { background: #e74c3c; color: white; }
        .type-fire { background: #ff6b6b; color: white; }
        .type-water { background: #4ecdc4; color: white; }
        .type-grass { background: #95e1d3; color: white; }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 45px;
            font-size: 1.3em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 15px;
            font-weight: bold;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-gm {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .btn-gm:hover:not(:disabled) {
            box-shadow: 0 15px 30px rgba(243, 156, 18, 0.4);
        }

        .price-tag {
            font-size: 1.1em;
            color: #27ae60;
            font-weight: bold;
            margin-top: 10px;
        }

        .daily-quest {
            background: linear-gradient(135deg, #fff9e6 0%, #ffe5b4 100%);
            border-left: 5px solid #f39c12;
            padding: 25px;
            margin: 30px 0;
            border-radius: 15px;
        }

        .quest-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .quest-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
        }

        .quest-reward {
            color: #27ae60;
            font-weight: bold;
            font-size: 1.1em;
        }

        .quest-desc {
            color: #666;
            margin: 10px 0;
        }

        .quest-timer {
            background: white;
            padding: 10px 20px;
            border-radius: 10px;
            margin-top: 15px;
            font-weight: bold;
            color: #667eea;
        }

        .loading {
            text-align: center;
            padding: 60px;
        }

        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.3em;
            color: #667eea;
        }

        .tx-info {
            background: #d1ecf1;
            border: 2px solid #17a2b8;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            word-break: break-all;
        }

        .tx-link {
            color: #3498db;
            text-decoration: none;
            font-weight: bold;
        }

        .tx-link:hover {
            text-decoration: underline;
        }

        .info-box {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }

        .info-box h3 {
            color: #2980b9;
            margin-bottom: 10px;
        }

        .empty-state {
            padding: 60px 20px;
            text-align: center;
        }

        .empty-icon {
            font-size: 5em;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-text {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 30px;
        }

        .countdown {
            font-size: 1.5em;
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <img src="https://i.postimg.cc/4N8v1F5Y/image.png" alt="AI Pet Arena Logo" class="logo-img">
                <div class="title-section">
                    <h1>AI Pet Arena</h1>
                    <span class="ink-badge">‚õìÔ∏è Ink Blockchain</span>
                </div>
            </div>
            <div class="wallet-section">
                <button id="walletBtn" class="wallet-btn" onclick="toggleWallet()">
                    üîå Connect Wallet
                </button>
                <div class="wallet-info" id="walletInfo" style="display: none;">
                    <span id="walletAddress" class="wallet-address"></span>
                    <span id="balance" class="balance"></span>
                </div>
            </div>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-label">üé® Pets Minted</div>
                <div class="stat-value" id="mintCount">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">‚òÄÔ∏è GM Streaks</div>
                <div class="stat-value" id="gmCount">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">üí∞ Total Spent</div>
                <div class="stat-value" id="totalSpent">0</div>
            </div>
        </div>

        <div id="mainContent" class="main-content">
            <div id="emptyState" class="empty-state">
                <div class="empty-icon">üéÆ</div>
                <div class="empty-text">Mint your first AI-generated pet!</div>
                <button class="btn" onclick="mintPet()">
                    üé≤ Mint Pet
                    <div class="price-tag">0.00001 ETH</div>
                </button>
            </div>

            <div id="petDisplay" class="pet-display" style="display: none;">
                <div class="pet-card">
                    <div class="pet-image-container" id="petImageContainer">
                        <div class="pet-emoji">üéÆ</div>
                    </div>
                    <div class="pet-name" id="petName">Your Pet</div>
                    <div id="petType" class="pet-type">Rock</div>
                </div>
                <button class="btn" onclick="mintPet()">
                    üîÑ Mint New Pet
                    <div class="price-tag">0.00001 ETH</div>
                </button>
            </div>

            <div id="loadingState" class="loading" style="display: none;">
                <div class="spinner"></div>
                <div class="loading-text" id="loadingText">Generating your AI pet...</div>
            </div>

            <div id="txInfo" style="display: none;"></div>
        </div>

        <div class="daily-quest">
            <div class="quest-header">
                <div class="quest-title">‚òÄÔ∏è Daily GM Quest</div>
                <div class="quest-reward">+0.000005 ETH</div>
            </div>
            <div class="quest-desc">
                Say GM to the community every day! Complete this quest to earn rewards.
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button id="gmButton" class="btn btn-gm" onclick="doGM()">
                    ‚òÄÔ∏è GM!
                </button>
            </div>
            <div class="quest-timer" id="questTimer">
                Next GM available in: <span id="countdown">00:00:00</span>
            </div>
        </div>

        <div class="info-box">
            <h3>üé® How It Works</h3>
            <p><strong>1.</strong> Connect your Ink wallet</p>
            <p><strong>2.</strong> Mint AI-generated pets for 0.00001 ETH each</p>
            <p><strong>3.</strong> Say GM daily to earn 0.000005 ETH</p>
            <p><strong>4.</strong> Collect unique pets and build your streak!</p>
        </div>

        <div class="info-box">
            <h3>üåê About Ink Blockchain</h3>
            <p>Ink is an Ethereum Layer 2 optimized for consumer apps. Ultra-low fees make it perfect for NFT minting and daily interactions!</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <script>
        let walletConnected = false;
        let userAddress = null;
        let provider = null;
        let signer = null;
        let currentPet = null;
        
        let mintCount = 0;
        let gmCount = 0;
        let totalSpent = 0;
        let lastGMTime = 0;

        const MINT_PRICE = "0.00001";
        const GM_REWARD = "0.000005";
        const GM_COOLDOWN = 24 * 60 * 60 * 1000; // 24 hours
        
        const INK_TESTNET = {
            chainId: '0xBAAC2',
            chainName: 'Ink Sepolia Testnet',
            nativeCurrency: { name: 'ETH', symbol: 'ETH', decimals: 18 },
            rpcUrls: ['https://rpc-gel-sepolia.inkonchain.com'],
            blockExplorerUrls: ['https://explorer-sepolia.inkonchain.com']
        };

        const petTypes = ['rock', 'paper', 'scissors', 'fire', 'water', 'grass'];
        
        const petEmojis = {
            rock: ['üóø', 'ü™®', '‚õ∞Ô∏è'],
            paper: ['üìÑ', 'ü¶Ö', 'üïäÔ∏è'],
            scissors: ['‚úÇÔ∏è', 'ü¶Ç', '‚öîÔ∏è'],
            fire: ['üî•', 'üåã', '‚òÑÔ∏è'],
            water: ['üíß', 'üåä', '‚ùÑÔ∏è'],
            grass: ['üåø', 'üå±', 'üçÉ']
        };

        const petDescriptions = {
            rock: 'ancient stone guardian',
            paper: 'mystical wind spirit',
            scissors: 'sharp blade warrior',
            fire: 'blazing inferno beast',
            water: 'crystalline ice serpent',
            grass: 'forest nature spirit'
        };

        // Load saved data
        function loadData() {
            mintCount = parseInt(localStorage.getItem('mintCount') || '0');
            gmCount = parseInt(localStorage.getItem('gmCount') || '0');
            totalSpent = parseFloat(localStorage.getItem('totalSpent') || '0');
            lastGMTime = parseInt(localStorage.getItem('lastGMTime') || '0');
            
            const savedPet = localStorage.getItem('currentPet');
            if (savedPet) {
                currentPet = JSON.parse(savedPet);
                showPet();
            }
            
            updateStats();
            updateGMButton();
        }

        function saveData() {
            localStorage.setItem('mintCount', mintCount);
            localStorage.setItem('gmCount', gmCount);
            localStorage.setItem('totalSpent', totalSpent);
            localStorage.setItem('lastGMTime', lastGMTime);
            if (currentPet) {
                localStorage.setItem('currentPet', JSON.stringify(currentPet));
            }
        }

        function updateStats() {
            document.getElementById('mintCount').textContent = mintCount;
            document.getElementById('gmCount').textContent = gmCount;
            document.getElementById('totalSpent').textContent = totalSpent.toFixed(5);
        }

        async function toggleWallet() {
            if (walletConnected) {
                disconnectWallet();
            } else {
                await connectWallet();
            }
        }

        async function connectWallet() {
            if (typeof window.ethereum === 'undefined') {
                alert('Please install MetaMask to connect your wallet!');
                return;
            }

            try {
                provider = new ethers.BrowserProvider(window.ethereum);
                const accounts = await provider.send("eth_requestAccounts", []);
                userAddress = accounts[0];

                try {
                    await window.ethereum.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: INK_TESTNET.chainId }],
                    });
                } catch (switchError) {
                    if (switchError.code === 4902) {
                        await window.ethereum.request({
                            method: 'wallet_addEthereumChain',
                            params: [INK_TESTNET],
                        });
                    }
                }

                signer = await provider.getSigner();
                walletConnected = true;

                document.getElementById('walletBtn').textContent = '‚úÖ Connected';
                document.getElementById('walletBtn').classList.add('connected');
                document.getElementById('walletAddress').textContent = 
                    `${userAddress.substring(0, 6)}...${userAddress.substring(38)}`;
                
                const balance = await provider.getBalance(userAddress);
                document.getElementById('balance').textContent = 
                    `üí∞ ${parseFloat(ethers.formatEther(balance)).toFixed(4)} ETH`;
                
                document.getElementById('walletInfo').style.display = 'flex';

            } catch (error) {
                console.error('Connection error:', error);
                alert('Failed to connect wallet: ' + error.message);
            }
        }

        function disconnectWallet() {
            walletConnected = false;
            userAddress = null;
            provider = null;
            signer = null;

            document.getElementById('walletBtn').textContent = 'üîå Connect Wallet';
            document.getElementById('walletBtn').classList.remove('connected');
            document.getElementById('walletInfo').style.display = 'none';
        }

        async function mintPet() {
            if (!walletConnected) {
                alert('Please connect your wallet first!');
                await connectWallet();
                return;
            }

            const confirmed = confirm(
                `Mint a new AI-generated pet?\n\n` +
                `Cost: ${MINT_PRICE} ETH\n` +
                `Network: Ink Sepolia Testnet`
            );
            
            if (!confirmed) return;

            showLoading('Processing transaction...');

            try {
                const tx = await signer.sendTransaction({
                    to: userAddress,
                    value: ethers.parseEther(MINT_PRICE)
                });

                showLoading('Transaction sent! Generating your pet...');
                await tx.wait();

                mintCount++;
                totalSpent += parseFloat(MINT_PRICE);
                saveData();
                updateStats();

                showTxInfo(tx.hash, 'Pet Minted');
                
                showLoading('AI is creating your unique pet...');
                await generatePet();
                
            } catch (error) {
                console.error('Mint error:', error);
                alert('Transaction failed: ' + error.message);
                hideLoading();
            }
        }

        async function generatePet() {
            const type = petTypes[Math.floor(Math.random() * petTypes.length)];
            
            try {
                const response = await fetch("https://api.anthropic.com/v1/messages", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        model: "claude-sonnet-4-20250514",
                        max_tokens: 1000,
                        messages: [{
                            role: "user",
                            content: `Generate a creative fantasy name for a ${type}-type creature. It's described as: "${petDescriptions[type]}". Respond with ONLY the name, maximum 2 words.`
                        }]
                    })
                });

                const data = await response.json();
                const aiName = data.content[0].text.trim();

                currentPet = {
                    name: aiName,
                    type: type,
                    emoji: petEmojis[type][Math.floor(Math.random() * petEmojis[type].length)]
                };

            } catch (error) {
                console.error('AI generation failed:', error);
                const fallbackNames = {
                    rock: ['Boulder', 'Granite'],
                    paper: ['Zephyr', 'Sky'],
                    scissors: ['Blade', 'Sharp'],
                    fire: ['Inferno', 'Blaze'],
                    water: ['Tide', 'Frost'],
                    grass: ['Leaf', 'Vine']
                };
                
                currentPet = {
                    name: fallbackNames[type][Math.floor(Math.random() * 2)],
                    type: type,
                    emoji: petEmojis[type][0]
                };
            }

            saveData();
            showPet();
            hideLoading();
        }

        function showPet() {
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('petDisplay').style.display = 'block';
            
            document.getElementById('petImageContainer').innerHTML = 
                `<div class="pet-emoji">${currentPet.emoji}</div>`;
            document.getElementById('petName').textContent = currentPet.name;
            document.getElementById('petType').className = `pet-type type-${currentPet.type}`;
            document.getElementById('petType').textContent = currentPet.type.toUpperCase();
        }

        function showLoading(text) {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('petDisplay').style.display = 'none';
            document.getElementById('loadingState').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loadingState').style.display = 'none';
        }

        function showTxInfo(hash, action) {
            const txInfo = document.getElementById('txInfo');
            txInfo.innerHTML = `
                <div class="tx-info">
                    ‚úÖ <strong>${action} Successfully!</strong><br>
                    TX: <a href="https://explorer-sepolia.inkonchain.com/tx/${hash}" target="_blank" class="tx-link">
                        ${hash.substring(0, 10)}...${hash.substring(56)}
                    </a>
                </div>
            `;
            txInfo.style.display = 'block';
        }

        async function doGM() {
            if (!walletConnected) {
                alert('Please connect your wallet first!');
                await connectWallet();
                return;
            }

            const now = Date.now();
            if (now - lastGMTime < GM_COOLDOWN) {
                alert('You can only say GM once every 24 hours!');
                return;
            }

            const confirmed = confirm(
                `Say GM to the community?\n\n` +
                `You'll receive: ${GM_REWARD} ETH\n` +
                `Network: Ink Sepolia Testnet`
            );
            
            if (!confirmed) return;

            showLoading('Sending GM transaction...');

            try {
                const tx = await signer.sendTransaction({
                    to: userAddress,
                    value: ethers.parseEther(GM_REWARD)
                });

                await tx.wait();

                gmCount++;
                lastGMTime = now;
                saveData();
                updateStats();
                updateGMButton();

                showTxInfo(tx.hash, 'GM Sent');
                hideLoading();
                
                alert('‚òÄÔ∏è GM! Your daily quest is complete!');
                
            } catch (error) {
                console.error('GM error:', error);
                alert('Transaction failed: ' + error.message);
                hideLoading();
            }
        }

        function updateGMButton() {
            const now = Date.now();
            const timeSinceLastGM = now - lastGMTime;
            
            if (timeSinceLastGM >= GM_COOLDOWN) {
                document.getElementById('gmButton').disabled = false;
                document.getElementById('countdown').textContent = 'Available Now!';
                document.getElementById('countdown').style.color = '#27ae60';
            } else {
                document.getElementById('gmButton').disabled = true;
                startCountdown();
            }
        }

        function startCountdown() {
            setInterval(() => {
                const now = Date.now();
                const timeLeft = GM_COOLDOWN - (now - lastGMTime);
                
                if (timeLeft <= 0) {
                    document.getElementById('countdown').textContent = 'Available Now!';
                    document.getElementById('countdown').style.color = '#27ae60';
                    document.getElementById('gmButton').disabled = false;
                    return;
                }
                
                const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                
                document.getElementById('countdown').textContent = 
                    `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                document.getElementById('countdown').style.color = '#e74c3c';
            }, 1000);
        }

        window.addEventListener('load', () => {
            loadData();
        });

        if (typeof window.ethereum !== 'undefined') {
            window.ethereum.on('accountsChanged', (accounts) => {
                if (accounts.length === 0) {
                    disconnectWallet();
                } else {
                    window.location.reload();
                }
            });

            window.ethereum.on('chainChanged', () => {
                window.location.reload();
            });
        }
    </script>
</body>
</html>
